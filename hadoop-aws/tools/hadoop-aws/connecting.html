<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
 | Generated by Apache Maven Doxia at 2024-10-22
 | Rendered using Apache Maven Stylus Skin 1.5
-->
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>Apache Hadoop Amazon Web Services support &#x2013; Connecting to an Amazon S3 Bucket through the S3A Connector</title>
    <style type="text/css" media="all">
      @import url("../../css/maven-base.css");
      @import url("../../css/maven-theme.css");
      @import url("../../css/site.css");
    </style>
    <link rel="stylesheet" href="../../css/print.css" type="text/css" media="print" />
        <meta name="Date-Revision-yyyymmdd" content="20241022" />
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
                </head>
  <body class="composite">
    <div id="banner">
                        <a href="http://hadoop.apache.org/" id="bannerLeft">
                                        <img src="http://hadoop.apache.org/images/hadoop-logo.jpg" alt="" />
                </a>
                              <a href="http://www.apache.org/" id="bannerRight">
                                        <img src="http://www.apache.org/images/asf_logo_wide.png" alt="" />
                </a>
            <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
                                     <div class="xright">            <a href="http://wiki.apache.org/hadoop" class="externalLink">Wiki</a>
            |
                <a href="https://gitbox.apache.org/repos/asf/hadoop.git" class="externalLink">git</a>
              
                                   &nbsp;| Last Published: 2024-10-22
              &nbsp;| Version: 3.5.0-SNAPSHOT
            </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
                                                   <h5>General</h5>
                  <ul>
                  <li class="none">
                  <a href="../../../index.html">Overview</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-common/SingleCluster.html">Single Node Setup</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-common/ClusterSetup.html">Cluster Setup</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-common/CommandsManual.html">Commands Reference</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-common/FileSystemShell.html">FileSystem Shell</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-common/Compatibility.html">Compatibility Specification</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-common/DownstreamDev.html">Downstream Developer's Guide</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-common/AdminCompatibilityGuide.html">Admin Compatibility Guide</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-common/InterfaceClassification.html">Interface Classification</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-common/filesystem/index.html">FileSystem Specification</a>
            </li>
          </ul>
                       <h5>Common</h5>
                  <ul>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-common/CLIMiniCluster.html">CLI Mini Cluster</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-common/FairCallQueue.html">Fair Call Queue</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-common/NativeLibraries.html">Native Libraries</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-common/Superusers.html">Proxy User</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-common/RackAwareness.html">Rack Awareness</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-common/SecureMode.html">Secure Mode</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-common/ServiceLevelAuth.html">Service Level Authorization</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-common/HttpAuthentication.html">HTTP Authentication</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-common/CredentialProviderAPI.html">Credential Provider API</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-kms/index.html">Hadoop KMS</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-common/Tracing.html">Tracing</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-common/UnixShellGuide.html">Unix Shell Guide</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-common/registry/index.html">Registry</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-common/AsyncProfilerServlet.html">Async Profiler</a>
            </li>
          </ul>
                       <h5>HDFS</h5>
                  <ul>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-hdfs/HdfsDesign.html">Architecture</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-hdfs/HdfsUserGuide.html">User Guide</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-hdfs/HDFSCommands.html">Commands Reference</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-hdfs/HDFSHighAvailabilityWithQJM.html">NameNode HA With QJM</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-hdfs/HDFSHighAvailabilityWithNFS.html">NameNode HA With NFS</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-hdfs/ObserverNameNode.html">Observer NameNode</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-hdfs/Federation.html">Federation</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-hdfs/ViewFs.html">ViewFs</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-hdfs/ViewFsOverloadScheme.html">ViewFsOverloadScheme</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-hdfs/HdfsSnapshots.html">Snapshots</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-hdfs/HdfsEditsViewer.html">Edits Viewer</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-hdfs/HdfsImageViewer.html">Image Viewer</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-hdfs/HdfsPermissionsGuide.html">Permissions and HDFS</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-hdfs/HdfsQuotaAdminGuide.html">Quotas and HDFS</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-hdfs/LibHdfs.html">libhdfs (C API)</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-hdfs/WebHDFS.html">WebHDFS (REST API)</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-hdfs-httpfs/index.html">HttpFS</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-hdfs/ShortCircuitLocalReads.html">Short Circuit Local Reads</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-hdfs/CentralizedCacheManagement.html">Centralized Cache Management</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-hdfs/HdfsNfsGateway.html">NFS Gateway</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-hdfs/HdfsRollingUpgrade.html">Rolling Upgrade</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-hdfs/ExtendedAttributes.html">Extended Attributes</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-hdfs/TransparentEncryption.html">Transparent Encryption</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-hdfs/HdfsMultihoming.html">Multihoming</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-hdfs/ArchivalStorage.html">Storage Policies</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-hdfs/MemoryStorage.html">Memory Storage Support</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-hdfs/SLGUserGuide.html">Synthetic Load Generator</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-hdfs/HDFSErasureCoding.html">Erasure Coding</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-hdfs/HDFSDiskbalancer.html">Disk Balancer</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-hdfs/HdfsUpgradeDomain.html">Upgrade Domain</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-hdfs/HdfsDataNodeAdminGuide.html">DataNode Admin</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-hdfs-rbf/HDFSRouterFederation.html">Router Federation</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-hdfs/HdfsProvidedStorage.html">Provided Storage</a>
            </li>
          </ul>
                       <h5>MapReduce</h5>
                  <ul>
                  <li class="none">
                  <a href="../../../hadoop-mapreduce-client/hadoop-mapreduce-client-core/MapReduceTutorial.html">Tutorial</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-mapreduce-client/hadoop-mapreduce-client-core/MapredCommands.html">Commands Reference</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-mapreduce-client/hadoop-mapreduce-client-core/MapReduce_Compatibility_Hadoop1_Hadoop2.html">Compatibility with 1.x</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-mapreduce-client/hadoop-mapreduce-client-core/EncryptedShuffle.html">Encrypted Shuffle</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-mapreduce-client/hadoop-mapreduce-client-core/PluggableShuffleAndPluggableSort.html">Pluggable Shuffle/Sort</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-mapreduce-client/hadoop-mapreduce-client-core/DistributedCacheDeploy.html">Distributed Cache Deploy</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-mapreduce-client/hadoop-mapreduce-client-core/SharedCacheSupport.html">Support for YARN Shared Cache</a>
            </li>
          </ul>
                       <h5>MapReduce REST APIs</h5>
                  <ul>
                  <li class="none">
                  <a href="../../../hadoop-mapreduce-client/hadoop-mapreduce-client-core/MapredAppMasterRest.html">MR Application Master</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-mapreduce-client/hadoop-mapreduce-client-hs/HistoryServerRest.html">MR History Server</a>
            </li>
          </ul>
                       <h5>YARN</h5>
                  <ul>
                  <li class="none">
                  <a href="../../../hadoop-yarn/hadoop-yarn-site/YARN.html">Architecture</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-yarn/hadoop-yarn-site/YarnCommands.html">Commands Reference</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-yarn/hadoop-yarn-site/CapacityScheduler.html">Capacity Scheduler</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-yarn/hadoop-yarn-site/FairScheduler.html">Fair Scheduler</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-yarn/hadoop-yarn-site/ResourceManagerRestart.html">ResourceManager Restart</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-yarn/hadoop-yarn-site/ResourceManagerHA.html">ResourceManager HA</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-yarn/hadoop-yarn-site/ResourceModel.html">Resource Model</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-yarn/hadoop-yarn-site/NodeLabel.html">Node Labels</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-yarn/hadoop-yarn-site/NodeAttributes.html">Node Attributes</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-yarn/hadoop-yarn-site/WebApplicationProxy.html">Web Application Proxy</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-yarn/hadoop-yarn-site/TimelineServer.html">Timeline Server</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-yarn/hadoop-yarn-site/TimelineServiceV2.html">Timeline Service V.2</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-yarn/hadoop-yarn-site/WritingYarnApplications.html">Writing YARN Applications</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-yarn/hadoop-yarn-site/YarnApplicationSecurity.html">YARN Application Security</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-yarn/hadoop-yarn-site/NodeManager.html">NodeManager</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-yarn/hadoop-yarn-site/DockerContainers.html">Running Applications in Docker Containers</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-yarn/hadoop-yarn-site/RuncContainers.html">Running Applications in runC Containers</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-yarn/hadoop-yarn-site/NodeManagerCgroups.html">Using CGroups</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-yarn/hadoop-yarn-site/SecureContainer.html">Secure Containers</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-yarn/hadoop-yarn-site/ReservationSystem.html">Reservation System</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-yarn/hadoop-yarn-site/GracefulDecommission.html">Graceful Decommission</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-yarn/hadoop-yarn-site/OpportunisticContainers.html">Opportunistic Containers</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-yarn/hadoop-yarn-site/Federation.html">YARN Federation</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-yarn/hadoop-yarn-site/SharedCache.html">Shared Cache</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-yarn/hadoop-yarn-site/UsingGpus.html">Using GPU</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-yarn/hadoop-yarn-site/UsingFPGA.html">Using FPGA</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-yarn/hadoop-yarn-site/PlacementConstraints.html">Placement Constraints</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-yarn/hadoop-yarn-site/YarnUI2.html">YARN UI2</a>
            </li>
          </ul>
                       <h5>YARN REST APIs</h5>
                  <ul>
                  <li class="none">
                  <a href="../../../hadoop-yarn/hadoop-yarn-site/WebServicesIntro.html">Introduction</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-yarn/hadoop-yarn-site/ResourceManagerRest.html">Resource Manager</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-yarn/hadoop-yarn-site/NodeManagerRest.html">Node Manager</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-yarn/hadoop-yarn-site/TimelineServer.html#Timeline_Server_REST_API_v1">Timeline Server</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-yarn/hadoop-yarn-site/TimelineServiceV2.html#Timeline_Service_v.2_REST_API">Timeline Service V.2</a>
            </li>
          </ul>
                       <h5>YARN Service</h5>
                  <ul>
                  <li class="none">
                  <a href="../../../hadoop-yarn/hadoop-yarn-site/yarn-service/Overview.html">Overview</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-yarn/hadoop-yarn-site/yarn-service/QuickStart.html">QuickStart</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-yarn/hadoop-yarn-site/yarn-service/Concepts.html">Concepts</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-yarn/hadoop-yarn-site/yarn-service/YarnServiceAPI.html">Yarn Service API</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-yarn/hadoop-yarn-site/yarn-service/ServiceDiscovery.html">Service Discovery</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-yarn/hadoop-yarn-site/yarn-service/SystemServices.html">System Services</a>
            </li>
          </ul>
                       <h5>Hadoop Compatible File Systems</h5>
                  <ul>
                  <li class="none">
                  <a href="../../../hadoop-aliyun/tools/hadoop-aliyun/index.html">Aliyun OSS</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-aws/tools/hadoop-aws/index.html">Amazon S3</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-azure/index.html">Azure Blob Storage</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-azure-datalake/index.html">Azure Data Lake Storage</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-cos/cloud-storage/index.html">Tencent COS</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-huaweicloud/cloud-storage/index.html">Huaweicloud OBS</a>
            </li>
          </ul>
                       <h5>Auth</h5>
                  <ul>
                  <li class="none">
                  <a href="../../../hadoop-auth/index.html">Overview</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-auth/Examples.html">Examples</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-auth/Configuration.html">Configuration</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-auth/BuildingIt.html">Building</a>
            </li>
          </ul>
                       <h5>Tools</h5>
                  <ul>
                  <li class="none">
                  <a href="../../../hadoop-streaming/HadoopStreaming.html">Hadoop Streaming</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-archives/HadoopArchives.html">Hadoop Archives</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-archive-logs/HadoopArchiveLogs.html">Hadoop Archive Logs</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-distcp/DistCp.html">DistCp</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-federation-balance/HDFSFederationBalance.html">HDFS Federation Balance</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-gridmix/GridMix.html">GridMix</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-rumen/Rumen.html">Rumen</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-resourceestimator/ResourceEstimator.html">Resource Estimator Service</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-sls/SchedulerLoadSimulator.html">Scheduler Load Simulator</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-common/Benchmarking.html">Hadoop Benchmarking</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-dynamometer/Dynamometer.html">Dynamometer</a>
            </li>
          </ul>
                       <h5>Reference</h5>
                  <ul>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-common/release/">Changelog and Release Notes</a>
            </li>
                  <li class="none">
                  <a href="../../../api/index.html">Java API docs</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-common/UnixShellAPI.html">Unix Shell API</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-common/Metrics.html">Metrics</a>
            </li>
          </ul>
                       <h5>Configuration</h5>
                  <ul>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-common/core-default.xml">core-default.xml</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-hdfs/hdfs-default.xml">hdfs-default.xml</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-hdfs-rbf/hdfs-rbf-default.xml">hdfs-rbf-default.xml</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-mapreduce-client/hadoop-mapreduce-client-core/mapred-default.xml">mapred-default.xml</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-yarn/hadoop-yarn-common/yarn-default.xml">yarn-default.xml</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-kms/kms-default.html">kms-default.xml</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-hdfs-httpfs/httpfs-default.html">httpfs-default.xml</a>
            </li>
                  <li class="none">
                  <a href="../../../hadoop-project-dist/hadoop-common/DeprecatedProperties.html">Deprecated Properties</a>
            </li>
          </ul>
                                 <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
          <img alt="Built by Maven" src="../../images/logos/maven-feather.png"/>
        </a>
                       
                               </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <!---
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

   http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License. See accompanying LICENSE file.
-->
<h1>Connecting to an Amazon S3 Bucket through the S3A Connector</h1>
<ul>
<li><a href="#Foundational_Concepts"> Foundational Concepts</a>
<ul>
<li><a href="#AWS_Regions_and_Availability_Zones">  AWS Regions and Availability Zones</a></li>
<li><a href="#Endpoints"> Endpoints</a></li>
<li><a href="#Third_party_stores"> Third party stores</a></li></ul></li>
<li><a href="#Connection_Settings"> Connection Settings</a>
<ul>
<li><a href="#S3_endpoint_and_region_settings_in_detail"> S3 endpoint and region settings in detail</a></li>
<li><a href="#Network_timeouts"> Network timeouts</a></li>
<li><a href="#Low-level_Network_Options"> Low-level Network Options</a></li>
<li><a href="#Proxy_Settings"> Proxy Settings</a></li></ul></li>
<li><a href="#Using_Per-Bucket_Configuration_to_access_data_round_the_world">Using Per-Bucket Configuration to access data round the world</a></li>
<li><a href="#AWS_PrivateLink"> AWS PrivateLink</a></li>
<li><a href="#Federal_Information_Processing_Standards_.28FIPS.29_Endpoints"> Federal Information Processing Standards (FIPS) Endpoints</a></li>
<li><a href="#Configuring_S3_AccessPoints_usage_with_S3A">Configuring S3 AccessPoints usage with S3A</a></li>
<li><a href="#Debugging_network_problems"> Debugging network problems</a></li>
<li><a href="#Common_Sources_of_Connection_Problems"> Common Sources of Connection Problems</a>
<ul>
<li><a href="#Inconsistent_configuration_across_a_cluster"> Inconsistent configuration across a cluster</a></li>
<li><a href="#Confusion_between_public.2Fprivate_S3_Stores."> Confusion between public/private S3 Stores.</a></li>
<li><a href="#Region_and_endpoints_misconfigured"> Region and endpoints misconfigured</a></li>
<li><a href="#Wildfly.2FOpenSSL_Brittleness"> Wildfly/OpenSSL Brittleness</a></li>
<li><a href="#Proxy_setup"> Proxy setup</a></li></ul></li></ul>

<ol style="list-style-type: decimal">

<li>This document covers how to connect to and authenticate with S3 stores, primarily AWS S3.</li>
<li>There have been changes in this mechanism between the V1 and V2 SDK, in particular specifying the region is now preferred to specifying the regional S3 endpoint.</li>
<li>For connecting to third-party stores, please read <a href="third_party_stores.html">Working with Third-party S3 Stores</a> <i>after</i> reading this document.</li>
</ol><section>
<h2><a name="Foundational_Concepts"></a><a name="foundational"></a> Foundational Concepts</h2><section>
<h3><a name="AWS_Regions_and_Availability_Zones"></a><a name="regions"></a>  AWS Regions and Availability Zones</h3>
<p>AWS provides storage, compute and other services around the world, in <i>regions</i>.</p>
<p>Data in S3 is stored <i>buckets</i>; each bucket is a single region.</p>
<p>There are some &#x201c;special&#x201d; regions: China, AWS GovCloud. It is <i>believed</i> that the S3A connector works in these places, at least to the extent that nobody has complained about it not working.</p></section><section>
<h3><a name="Endpoints"></a><a name="endpoints"></a> Endpoints</h3>
<p>The S3A connector connects to Amazon S3 storage over HTTPS connections, either directly or through an HTTP proxy. HTTP HEAD and GET, PUT, POST and DELETE requests are invoked to perform different read/write operations against the store.</p>
<p>There are multiple ways to connect to an S3 bucket</p>
<ul>

<li>To an <a class="externalLink" href="https://docs.aws.amazon.com/general/latest/gr/s3.html">S3 Endpoint</a>; an HTTPS server hosted by amazon or a third party.</li>
<li>To a FIPS-compliant S3 Endpoint.</li>
<li>To an AWS S3 <a class="externalLink" href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-points.html">Access Point</a>.</li>
<li>Through a VPC connection, <a class="externalLink" href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/privatelink-interface-endpoints.html">AWS PrivateLink for Amazon S3</a>.</li>
<li>AWS <a class="externalLink" href="https://aws.amazon.com/outposts/">Outposts</a>.</li>
</ul>
<p>The S3A connector supports all these; S3 Endpoints are the primary mechanism used -either explicitly declared or automatically determined from the declared region of the bucket.</p>
<p>The S3A connector supports S3 cross region access via AWS SDK which is enabled by default. This allows users to access S3 buckets in a different region than the one defined in the S3 endpoint/region configuration, as long as they are within the same AWS partition. However, S3 cross-region access can be disabled by:</p>

<div class="source">
<div class="source">
<pre>&lt;property&gt;
  &lt;name&gt;fs.s3a.cross.region.access.enabled&lt;/name&gt;
  &lt;value&gt;false&lt;/value&gt;
  &lt;description&gt;S3 cross region access&lt;/description&gt;
&lt;/property&gt;
</pre></div></div>

<p>Not supported: * AWS <a class="externalLink" href="https://aws.amazon.com/snowball/">Snowball</a>.</p>
<p>As of December 2023, AWS S3 uses Transport Layer Security (TLS) <a class="externalLink" href="https://aws.amazon.com/blogs/security/tls-1-2-required-for-aws-endpoints/">version 1.2</a> to secure the communications channel; the S3A client is does this through the Apache <a class="externalLink" href="https://hc.apache.org/index.html">HttpClient library</a>.</p></section><section>
<h3><a name="Third_party_stores"></a><a name="third-party"></a> Third party stores</h3>
<p>Third-party stores implementing the S3 API are also supported. These often only implement a subset of the S3 API; not all features are available. If TLS authentication is used, then the HTTPS certificates for the private stores <i>MUST</i> be installed on the JVMs on hosts within the Hadoop cluster.</p>
<p>See <a href="third_party_stores.html">Working with Third-party S3 Stores</a> <i>after</i> reading this document.</p></section></section><section>
<h2><a name="Connection_Settings"></a><a name="settings"></a> Connection Settings</h2>
<p>There are three core settings to connect to an S3 store, endpoint, region and whether or not to use path style access.</p>

<div class="source">
<div class="source">
<pre>&lt;property&gt;
  &lt;name&gt;fs.s3a.endpoint&lt;/name&gt;
  &lt;description&gt;AWS S3 endpoint to connect to. An up-to-date list is
    provided in the AWS Documentation: regions and endpoints. Without this
    property, the endpoint/hostname of the S3 Store is inferred from
    the value of fs.s3a.endpoint.region, fs.s3a.endpoint.fips and more.
  &lt;/description&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;fs.s3a.endpoint.region&lt;/name&gt;
  &lt;value&gt;REGION&lt;/value&gt;
  &lt;description&gt;AWS Region of the data&lt;/description&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;fs.s3a.path.style.access&lt;/name&gt;
  &lt;value&gt;false&lt;/value&gt;
  &lt;description&gt;Enable S3 path style access by disabling the default virtual hosting behaviour.
    Needed for AWS PrivateLink, S3 AccessPoints, and, generally, third party stores.
    Default: false.
  &lt;/description&gt;
&lt;/property&gt;
</pre></div></div>

<p>Historically the S3A connector has preferred the endpoint as defined by the option <code>fs.s3a.endpoint</code>. With the move to the AWS V2 SDK, there is more emphasis on the region, set by the <code>fs.s3a.endpoint.region</code> option.</p>
<p>Normally, declaring the region in <code>fs.s3a.endpoint.region</code> should be sufficient to set up the network connection to correctly connect to an AWS-hosted S3 store.</p><section>
<h3><a name="S3_endpoint_and_region_settings_in_detail"></a><a name="s3_endpoint_region_details"></a> S3 endpoint and region settings in detail</h3>
<ul>

<li>Configs <code>fs.s3a.endpoint</code> and <code>fs.s3a.endpoint.region</code> are used to set values for S3 endpoint and region respectively.</li>
<li>If <code>fs.s3a.endpoint.region</code> is configured with valid AWS region value, S3A will configure the S3 client to use this value. If this is set to a region that does not match your bucket, you will receive a 301 redirect response.</li>
<li>If <code>fs.s3a.endpoint.region</code> is not set and <code>fs.s3a.endpoint</code> is set with valid endpoint value, S3A will attempt to parse the region from the endpoint and configure S3 client to use the region value.</li>
<li>If both <code>fs.s3a.endpoint</code> and <code>fs.s3a.endpoint.region</code> are not set, S3A will use <code>us-east-2</code> as default region and enable cross region access. In this case, S3A does not attempt to override the endpoint while configuring the S3 client.</li>
<li>If <code>fs.s3a.endpoint</code> is not set and <code>fs.s3a.endpoint.region</code> is set to an empty string, S3A will configure S3 client without any region or endpoint override. This will allow fallback to S3 SDK region resolution chain. More details <a class="externalLink" href="https://docs.aws.amazon.com/sdk-for-java/latest/developer-guide/region-selection.html">here</a>.</li>
<li>If <code>fs.s3a.endpoint</code> is set to central endpoint <code>s3.amazonaws.com</code> and <code>fs.s3a.endpoint.region</code> is not set, S3A will use <code>us-east-2</code> as default region and enable cross region access. In this case, S3A does not attempt to override the endpoint while configuring the S3 client.</li>
<li>If <code>fs.s3a.endpoint</code> is set to central endpoint <code>s3.amazonaws.com</code> and <code>fs.s3a.endpoint.region</code> is also set to some region, S3A will use that region value and enable cross region access. In this case, S3A does not attempt to override the endpoint while configuring the S3 client.</li>
</ul>
<p>When the cross region access is enabled while configuring the S3 client, even if the region set is incorrect, S3 SDK determines the region. This is done by making the request, and if the SDK receives 301 redirect response, it determines the region at the cost of a HEAD request, and caches it.</p>
<p>Please note that some endpoint and region settings that require cross region access are complex and improving over time. Hence, they may be considered unstable.</p>
<p>If you are working with third party stores, please check <a href="third_party_stores.html">third party stores in detail</a>.</p></section><section>
<h3><a name="Network_timeouts"></a><a name="timeouts"></a> Network timeouts</h3>
<p>See <a href="performance.html#timeouts">Timeouts</a>.</p></section><section>
<h3><a name="Low-level_Network_Options"></a><a name="networking"></a> Low-level Network Options</h3>

<div class="source">
<div class="source">
<pre>&lt;property&gt;
  &lt;name&gt;fs.s3a.connection.maximum&lt;/name&gt;
  &lt;value&gt;200&lt;/value&gt;
  &lt;description&gt;Controls the maximum number of simultaneous connections to S3.
    This must be bigger than the value of fs.s3a.threads.max so as to stop
    threads being blocked waiting for new HTTPS connections.
  &lt;/description&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;fs.s3a.connection.ssl.enabled&lt;/name&gt;
  &lt;value&gt;true&lt;/value&gt;
  &lt;description&gt;
    Enables or disables SSL connections to AWS services.
  &lt;/description&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;fs.s3a.ssl.channel.mode&lt;/name&gt;
  &lt;value&gt;Default_JSSE&lt;/value&gt;
  &lt;description&gt;
    TLS implementation and cipher options.
    Values: OpenSSL, Default, Default_JSSE, Default_JSSE_with_GCM

    Default_JSSE is not truly the the default JSSE implementation because
    the GCM cipher is disabled when running on Java 8. However, the name
    was not changed in order to preserve backwards compatibility. Instead,
    new mode called Default_JSSE_with_GCM delegates to the default JSSE
    implementation with no changes to the list of enabled ciphers.

    OpenSSL requires the wildfly JAR on the classpath and a compatible installation of the openssl binaries.
    It is often faster than the JVM libraries, but also trickier to
    use.
  &lt;/description&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;fs.s3a.socket.send.buffer&lt;/name&gt;
  &lt;value&gt;8192&lt;/value&gt;
  &lt;description&gt;
    Socket send buffer hint to amazon connector. Represented in bytes.
  &lt;/description&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;fs.s3a.socket.recv.buffer&lt;/name&gt;
  &lt;value&gt;8192&lt;/value&gt;
  &lt;description&gt;
    Socket receive buffer hint to amazon connector. Represented in bytes.
  &lt;/description&gt;
&lt;/property&gt;
</pre></div></div>
</section><section>
<h3><a name="Proxy_Settings"></a><a name="proxies"></a> Proxy Settings</h3>
<p>Connections to S3A stores can be made through an HTTP or HTTPS proxy.</p>

<div class="source">
<div class="source">
<pre>&lt;property&gt;
  &lt;name&gt;fs.s3a.proxy.host&lt;/name&gt;
  &lt;description&gt;
    Hostname of the (optional) proxy server for S3 connections.
  &lt;/description&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;fs.s3a.proxy.ssl.enabled&lt;/name&gt;
  &lt;value&gt;false&lt;/value&gt;
  &lt;description&gt;
    Does the proxy use a TLS connection?
  &lt;/description&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;fs.s3a.proxy.port&lt;/name&gt;
  &lt;description&gt;
    Proxy server port. If this property is not set
    but fs.s3a.proxy.host is, port 80 or 443 is assumed (consistent with
    the value of fs.s3a.connection.ssl.enabled).
  &lt;/description&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;fs.s3a.proxy.username&lt;/name&gt;
  &lt;description&gt;Username for authenticating with proxy server.&lt;/description&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;fs.s3a.proxy.password&lt;/name&gt;
  &lt;description&gt;Password for authenticating with proxy server.&lt;/description&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;fs.s3a.proxy.domain&lt;/name&gt;
  &lt;description&gt;Domain for authenticating with proxy server.&lt;/description&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;fs.s3a.proxy.workstation&lt;/name&gt;
  &lt;description&gt;Workstation for authenticating with proxy server.&lt;/description&gt;
&lt;/property&gt;
</pre></div></div>

<p>Sometimes the proxy can be source of problems, especially if HTTP connections are kept in the connection pool for some time. Experiment with the values of <code>fs.s3a.connection.ttl</code> and <code>fs.s3a.connection.request.timeout</code> if long-lived connections have problems.</p></section></section><section>
<h2><a name="Using_Per-Bucket_Configuration_to_access_data_round_the_world"></a><a name="per_bucket_endpoints"></a>Using Per-Bucket Configuration to access data round the world</h2>
<p>S3 Buckets are hosted in different &#x201c;regions&#x201d;, the default being &#x201c;US-East-1&#x201d;. The S3A client talks to this region by default, issuing HTTP requests to the server <code>s3.amazonaws.com</code>.</p>
<p>S3A can work with buckets from any region. Each region has its own S3 endpoint, documented <a class="externalLink" href="http://docs.aws.amazon.com/general/latest/gr/rande.html#s3_region">by Amazon</a>.</p>
<ol style="list-style-type: decimal">

<li>Applications running in EC2 infrastructure do not pay for IO to/from <i>local S3 buckets</i>. They will be billed for access to remote buckets. Always use local buckets and local copies of data, wherever possible.</li>
<li>With the V4 signing protocol, AWS requires the explicit region endpoint to be used &#x2014;hence S3A must be configured to use the specific endpoint. This is done by setting the regon in the configuration option <code>fs.s3a.endpoint.region</code>, or by explicitly setting <code>fs.s3a.endpoint</code> and <code>fs.s3a.endpoint.region</code>.</li>
<li>All endpoints other than the default region only support interaction with buckets local to that S3 instance.</li>
<li>Standard S3 buckets support &#x201c;cross-region&#x201d; access where use of the original <code>us-east-1</code> endpoint allows access to the data, but newer storage types, particularly S3 Express are not supported.</li>
</ol>
<p>If the wrong endpoint is used, the request will fail. This may be reported as a 301/redirect error, or as a 400 Bad Request: take these as cues to check the endpoint setting of a bucket.</p>
<p>The up to date list of regions is <a class="externalLink" href="https://docs.aws.amazon.com/general/latest/gr/s3.html">Available online</a>.</p>
<p>This list can be used to specify the endpoint of individual buckets, for example for buckets in the us-west-2 and EU/Ireland endpoints.</p>

<div class="source">
<div class="source">
<pre>&lt;property&gt;
  &lt;name&gt;fs.s3a.bucket.us-west-2-dataset.endpoint.region&lt;/name&gt;
  &lt;value&gt;us-west-2&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;fs.s3a.bucket.eu-dataset.endpoint.region&lt;/name&gt;
  &lt;value&gt;eu-west-1&lt;/value&gt;
&lt;/property&gt;
</pre></div></div>
</section><section>
<h2><a name="AWS_PrivateLink"></a><a name="privatelink"></a> AWS PrivateLink</h2>
<p><a class="externalLink" href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/privatelink-interface-endpoints.html">AWS PrivateLink for Amazon S3</a> allows for a private connection to a bucket to be defined, with network access rules managing how a bucket can be accessed.</p>
<ol style="list-style-type: decimal">

<li>Follow the documentation to create the private link</li>
<li>retrieve the DNS name from the console, such as <code>vpce-f264a96c-6d27bfa7c85e.s3.us-west-2.vpce.amazonaws.com</code></li>
<li>Convert this to an endpoint URL by prefixing &#x201c;<a class="externalLink" href="https://bucket">https://bucket</a>.&#x201d;</li>
<li>Declare this as the bucket endpoint and switch to path-style access.</li>
<li>Declare the region: there is no automated determination of the region from the <code>vpce</code> URL.</li>
</ol>

<div class="source">
<div class="source">
<pre>&lt;property&gt;
  &lt;name&gt;fs.s3a.bucket.example-usw2.endpoint&lt;/name&gt;
  &lt;value&gt;https://bucket.vpce-f264a96c-6d27bfa7c85e.s3.us-west-2.vpce.amazonaws.com/&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;fs.s3a.bucket.example-usw2.path.style.access&lt;/name&gt;
  &lt;value&gt;true&lt;/value&gt;
&lt;/property&gt;

&lt;property&gt;
  &lt;name&gt;fs.s3a.bucket.example-usw2.endpoint.region&lt;/name&gt;
  &lt;value&gt;us-west-2&lt;/value&gt;
&lt;/property&gt;
</pre></div></div>
</section><section>
<h2><a name="Federal_Information_Processing_Standards_.28FIPS.29_Endpoints"></a><a name="fips"></a> Federal Information Processing Standards (FIPS) Endpoints</h2>
<p>It is possible to use <a class="externalLink" href="https://www.nist.gov/itl/fips-general-information">FIPs-compliant</a> endpoints which support a restricted subset of TLS algorithms.</p>
<p>Amazon provide a specific set of <a class="externalLink" href="https://aws.amazon.com/compliance/fips/">FIPS endpoints</a> to use so callers can be confident that the network communication is compliant with the standard: non-compliant algorithms are unavailable.</p>
<p>The boolean option <code>fs.s3a.endpoint.fips</code> (default <code>false</code>) switches the S3A connector to using the FIPS endpoint of a region.</p>

<div class="source">
<div class="source">
<pre>&lt;property&gt;
  &lt;name&gt;fs.s3a.endpoint.fips&lt;/name&gt;
  &lt;value&gt;true&lt;/value&gt;
  &lt;description&gt;Use the FIPS endpoint&lt;/description&gt;
&lt;/property&gt;
</pre></div></div>

<p>For a single bucket:</p>

<div class="source">
<div class="source">
<pre>&lt;property&gt;
  &lt;name&gt;fs.s3a.bucket.noaa-isd-pds.endpoint.fips&lt;/name&gt;
  &lt;value&gt;true&lt;/value&gt;
  &lt;description&gt;Use the FIPS endpoint for the NOAA dataset&lt;/description&gt;
&lt;/property&gt;
</pre></div></div>

<p>If <code>fs.s3a.endpoint.fips</code> is <code>true</code>, the endpoint option <code>fs.s3a.endpoint</code> MUST NOT be set to any non-central endpoint value. If <code>fs.s3a.endpoint.fips</code> is <code>true</code>, the only <i>optionally</i> allowed value for <code>fs.s3a.endpoint</code> is central endpoint <code>s3.amazonaws.com</code>.</p>
<p>S3A error message if <code>s3.eu-west-2.amazonaws.com</code> endpoint is used with FIPS:</p>

<div class="source">
<div class="source">
<pre>Non central endpoint cannot be set when fs.s3a.endpoint.fips is true : https://s3.eu-west-2.amazonaws.com
</pre></div></div>

<p>S3A validation is used to fail-fast before the SDK returns error.</p>
<p>AWS SDK error message if S3A does not fail-fast:</p>

<div class="source">
<div class="source">
<pre>A custom endpoint cannot be combined with FIPS: https://s3.eu-west-2.amazonaws.com
</pre></div></div>

<p>The SDK calculates the FIPS-specific endpoint without any awareness as to whether FIPs is supported by a region. The first attempt to interact with the service will fail</p>

<div class="source">
<div class="source">
<pre>java.net.UnknownHostException: software.amazon.awssdk.core.exception.SdkClientException:
Received an UnknownHostException when attempting to interact with a service.
    See cause for the exact endpoint that is failing to resolve.
    If this is happening on an endpoint that previously worked,
    there may be a network connectivity issue or your DNS cache
    could be storing endpoints for too long.:
    example-london-1.s3-fips.eu-west-2.amazonaws.com

</pre></div></div>

<p>For more details on endpoint and region settings, please check <a href="connecting.html#s3_endpoint_region_details">S3 endpoint and region settings in detail</a>.</p>
<p><i>Important</i> OpenSSL and FIPS endpoints</p>
<p>Linux distributions with an FIPS-compliant SSL library may not be compatible with wildfly. Always use with the JDK SSL implementation unless you are confident that the library is compatible, or wish to experiment with the settings outside of production deployments.</p>

<div class="source">
<div class="source">
<pre>&lt;property&gt;
  &lt;name&gt;fs.s3a.ssl.channel.mode&lt;/name&gt;
  &lt;value&gt;Default_JSSE&lt;/value&gt;
&lt;/property&gt;
</pre></div></div>
</section><section>
<h2><a name="Configuring_S3_AccessPoints_usage_with_S3A"></a><a name="accesspoints"></a>Configuring S3 AccessPoints usage with S3A</h2>
<p>S3A supports <a class="externalLink" href="https://aws.amazon.com/s3/features/access-points/">S3 Access Point</a> usage which improves VPC integration with S3 and simplifies your data&#x2019;s permission model because different policies can be applied now on the Access Point level. For more information about why to use and how to create them make sure to read the official documentation.</p>
<p>Accessing data through an access point, is done by using its ARN, as opposed to just the bucket name. You can set the Access Point ARN property using the following per bucket configuration property:</p>

<div class="source">
<div class="source">
<pre>&lt;property&gt;
  &lt;name&gt;fs.s3a.bucket.sample-bucket.accesspoint.arn&lt;/name&gt;
  &lt;value&gt; {ACCESSPOINT_ARN_HERE} &lt;/value&gt;
  &lt;description&gt;Configure S3a traffic to use this AccessPoint&lt;/description&gt;
&lt;/property&gt;
</pre></div></div>

<p>This configures access to the <code>sample-bucket</code> bucket for S3A, to go through the new Access Point ARN. So, for example <code>s3a://sample-bucket/key</code> will now use your configured ARN when getting data from S3 instead of your bucket.</p>
<p><i>the name of the bucket used in the <a class="externalLink" href="s3a://">s3a://</a> URLs is irrelevant; it is not used when connecting with the store</i></p>
<p>Example</p>

<div class="source">
<div class="source">
<pre>&lt;property&gt;
  &lt;name&gt;fs.s3a.bucket.example-ap.accesspoint.arn&lt;/name&gt;
  &lt;value&gt;arn:aws:s3:eu-west-2:152813717728:accesspoint/ap-example-london&lt;/value&gt;
  &lt;description&gt;AccessPoint bound to bucket name example-ap&lt;/description&gt;
&lt;/property&gt;
</pre></div></div>

<p>The <code>fs.s3a.accesspoint.required</code> property can also require all access to S3 to go through Access Points. This has the advantage of increasing security inside a VPN / VPC as you only allow access to known sources of data defined through Access Points. In case there is a need to access a bucket directly (without Access Points) then you can use per bucket overrides to disable this setting on a bucket by bucket basis i.e. <code>fs.s3a.bucket.{YOUR-BUCKET}.accesspoint.required</code>.</p>

<div class="source">
<div class="source">
<pre>&lt;!-- Require access point only access --&gt;
&lt;property&gt;
  &lt;name&gt;fs.s3a.accesspoint.required&lt;/name&gt;
  &lt;value&gt;true&lt;/value&gt;
&lt;/property&gt;
&lt;!-- Disable it on a per-bucket basis if needed --&gt;
&lt;property&gt;
  &lt;name&gt;fs.s3a.bucket.example-bucket.accesspoint.required&lt;/name&gt;
  &lt;value&gt;false&lt;/value&gt;
&lt;/property&gt;
</pre></div></div>

<p>Before using Access Points make sure you&#x2019;re not impacted by the following: - The endpoint for S3 requests will automatically change to use <code>s3-accesspoint.REGION.amazonaws.{com | com.cn}</code> depending on the Access Point ARN. While considering endpoints, if you have any custom signers that use the host endpoint property make sure to update them if needed;</p></section><section>
<h2><a name="Debugging_network_problems"></a><a name="debugging"></a> Debugging network problems</h2>
<p>The <code>storediag</code> command within the utility <a class="externalLink" href="https://github.com/exampleoughran/cloudstore">cloudstore</a> JAR is recommended as the way to view and print settings.</p>
<p>If <code>storediag</code> doesn&#x2019;t connect to your S3 store, <i>nothing else will</i>.</p></section><section>
<h2><a name="Common_Sources_of_Connection_Problems"></a><a name="common-problems"></a> Common Sources of Connection Problems</h2>
<p>Based on the experience of people who field support calls, here are some of the main connectivity issues which cause problems.</p><section>
<h3><a name="Inconsistent_configuration_across_a_cluster"></a><a name="inconsistent-config"></a> Inconsistent configuration across a cluster</h3>
<p>All hosts in the cluster need to have the configuration secrets; local environment variables are not enough.</p>
<p>If HTTPS/TLS is used for a private store, the relevant certificates MUST be installed everywhere.</p>
<p>For applications such as distcp, the options need to be passed with the job.</p></section><section>
<h3><a name="Confusion_between_public.2Fprivate_S3_Stores."></a><a name="public-private-mixup"></a> Confusion between public/private S3 Stores.</h3>
<p>If your cluster is configured to use a private store, AWS-hosted buckets are not visible. If you wish to read access in a private store, you need to change the endpoint.</p>
<p>Private S3 stores generally expect path style access.</p></section><section>
<h3><a name="Region_and_endpoints_misconfigured"></a><a name="region-misconfigure"></a> Region and endpoints misconfigured</h3>
<p>These usually surface rapidly and with meaningful messages.</p>
<p>Region errors generally surface as * <code>UnknownHostException</code> * <code>AWSRedirectException</code> &#x201c;Received permanent redirect response to region&#x201d;</p>
<p>Endpoint configuration problems can be more varied, as they are just HTTPS URLs.</p></section><section>
<h3><a name="Wildfly.2FOpenSSL_Brittleness"></a><a name="wildfly"></a> Wildfly/OpenSSL Brittleness</h3>
<p>When it works, it is fast. But it is fussy as to openSSL implementations, TLS protocols and more. Because it uses the native openssl binaries, operating system updates can trigger regressions.</p>
<p>Disabling it should be the first step to troubleshooting any TLS problems.</p></section><section>
<h3><a name="Proxy_setup"></a><a name="proxy-misconfiguration"></a> Proxy setup</h3>
<p>If there is a proxy, set it up correctly.</p></section></section>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
        &#169;            2008-2024
              Apache Software Foundation
            
                          - <a href="http://maven.apache.org/privacy-policy.html">Privacy Policy</a>.
        Apache Maven, Maven, Apache, the Apache feather logo, and the Apache Maven project logos are trademarks of The Apache Software Foundation.
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
